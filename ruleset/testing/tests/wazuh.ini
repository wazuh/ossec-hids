# Active response

[wazuh: active response: add host]
log 1 pass = Sat May  7 03:17:27 CDT 2011 /INSTALLATION/PATH/active-response/bin/host-deny.sh add - 172.16.0.1 1304756247.60385 31151
rule = 603
alert = 3
decoder = ar_log

[wazuh: active response: add firewall]
log 1 pass = Sat May  7 03:17:27 CDT 2011 /INSTALLATION/PATH/active-response/bin/firewall-drop.sh add - 172.16.0.1 1304756247.60385 31151
rule = 601
alert = 3
decoder = ar_log

[wazuh: active response: delete host]
log 1 pass = Sat May  7 03:27:57 CDT 2011 /INSTALLATION/PATH/active-response/bin/host-deny.sh delete - 172.16.0.1 1304756247.60385 31151
rule = 604
alert = 3
decoder = ar_log

[wazuh: active response: delete firewall]
log 1 pass = Sat May  7 03:27:57 CDT 2011 /INSTALLATION/PATH/active-response/bin/firewall-drop.sh delete - 172.16.0.1 1304756247.60385 31151

rule = 602
alert = 3
decoder = ar_log

# wazuh-logcollector

[wazuh-logcollector: ignore informational messages at startup]
log 1 pass = 2015/01/29 21:09:49 wazuh-logcollector(1950): INFO: Analyzing file: '/var/log/httpd/error_log'.
log 2 pass = 2015/01/29 21:09:49 ossec-logcollector(1950): INFO: Analyzing file: '/var/log/httpd/error_log'.

rule = 701
alert = 0
decoder = wazuh-logcollector

# Agent's logs

[wazuh: agent's logs: started]
log 1 pass = wazuh: Agent started: 'Agent1->any'.
log 2 pass = ossec: Agent started: 'Agent1->any'.

rule = 501
alert = 3
decoder = wazuh

[wazuh: agent's logs: disconnected]
log 1 pass = wazuh: Agent disconnected: 'Agent1'.
log 2 pass = ossec: Agent disconnected: 'Agent1'.

rule = 504
alert = 3
decoder = wazuh

[wazuh: agent's logs: removed]
log 1 pass = wazuh: Agent removed: 'Agent1'.

rule = 505
alert = 3
decoder = wazuh

# Server's logs

[wazuh: server's logs: started]
log 1 pass = wazuh: Wazuh started.

rule = 502
alert = 3
decoder = wazuh

# Audit

[wazuh: audit: wazuh]
log 1 pass = wazuh: Audit: Detected rules manipulation: Audit rules removed
log 2 pass = ossec: Audit: Detected rules manipulation: Audit rules removed

rule = 517
alert = 7
decoder = wazuh

# Command output

[wazuh: command output: wazuh]
log 1 pass = wazuh: output: 'command output'
log 2 pass = ossec: output: 'command output'

rule = 530
alert = 0
decoder = wazuh

[wazuh: command output: disk usage]
log 1 pass = wazuh: output: 'df -P': /dev/loop0 8653 8453 0 100% /mnt/test
log 2 pass = ossec: output: 'df -P': /dev/loop0 8653 8453 0 100% /mnt/test

rule = 531
alert = 7
decoder = wazuh

[wazuh: command output: legacy netstat listening ports]
log 1 fail = wazuh: output: 'netstat listening ports': tcp 0.0.0.0:8080 0.0.0.0:* 12345/process
log 2 pass = wazuh: output: 'netstat listening ports': tcp 0.0.0.0:8081 0.0.0.0:* 12345/process
log 3 fail = wazuh: output: 'netstat listening ports': tcp 0.0.0.0:8081 0.0.0.0:* 12345/process
log 4 pass = ossec: output: 'netstat listening ports': tcp 0.0.0.0:8081 0.0.0.0:* 12345/process
log 5 pass = ossec: output: 'netstat listening ports': tcp 0.0.0.0:8080 0.0.0.0:* 12345/process
log 6 fail = ossec: output: 'netstat listening ports': tcp 0.0.0.0:8080 0.0.0.0:* 12345/process

rule = 533
alert = 7
decoder = wazuh

[wazuh: command output: wazuh logged in users]
log 1 fail = wazuh: output: 'w': vagrant pts/1 10.0.2.2 Wed Dec  2 03:54 - 04:00  (00:02)
log 2 pass = wazuh: output: 'w': reboot system boot 3.10.0-1127.19.1 Tue Dec  1 13:09 - 21:10  (08:52)
log 3 fail = wazuh: output: 'w': reboot system boot 3.10.0-1127.19.1 Tue Dec  1 13:09 - 21:10  (08:52)
log 4 pass = ossec: output: 'w': reboot system boot 3.10.0-1127.19.1 Tue Dec  1 13:09 - 21:10  (08:52)
log 5 pass = ossec: output: 'w': vagrant pts/1 10.0.2.2 Wed Dec  2 03:54 - 04:00  (00:02)
log 6 fail = ossec: output: 'w': vagrant pts/1 10.0.2.2 Wed Dec  2 03:54 - 04:00  (00:02)

rule = 534
alert = 1
decoder = wazuh

[wazuh: command output: wazuh last logged users]
log 1 fail = wazuh: output: 'last -n 20': reboot system boot 3.10.0-1127.19.1 Wed Dec  2 20:30 - 03:34  (07:04)
log 2 pass = ossec: output: 'last -n 20': vagrant pts/1 10.0.2.2  Wed Dec  2 14:20 - 14:42  (00:21)

rule = 535
alert = 1
decoder = wazuh

# Agentless

[wazuh: agentless: wazuh]
log 1 pass = wazuh: agentless: Change detected:

rule = 555
alert = 7
decoder = wazuh

# Queue

[wazuh: queue full: wazuh]
log 1 pass = wazuh: Real-time inotify kernel queue is full.
log 2 pass = ossec: Real-time inotify kernel queue is full.

rule = 560
alert = 7
decoder = wazuh

# Files and logs

[wazuh: file rotated: wazuh]
log 1 pass = wazuh: File rotated (inode changed): '/var/log/syslog'.
log 2 pass = ossec: File rotated (inode changed): '/var/log/syslog'.

rule = 591
alert = 3
decoder = wazuh

[wazuh: file reduced: wazuh]
log 1 pass = wazuh: File size reduced (inode changed): '/var/log/syslog'.
log 2 pass = ossec: File size reduced (inode changed): '/var/log/syslog'.

rule = 592
alert = 8
decoder = wazuh

[wazuh: log cleared: wazuh]
log 1 pass = wazuh: Event log cleared: 'example_log'.
log 2 pass = ossec: Event log cleared: 'example_log'.

rule = 593
alert = 9
decoder = wazuh

# Attack rules

[attack rules: system users: wazuh]
log 1 pass = Dec  1 14:11:57 localhost sudo: pam_unix(sudo:session): session opened for user wazuh by vagrant(uid=0)
log 2 pass = Dec  1 14:11:57 localhost sudo: pam_unix(sudo:session): session opened for user ossec by vagrant(uid=0)

rule = 40101
alert = 12
decoder = pam

# WazuhAlert_Decoder

[wazuh: plugin: wazuh]
log 1 pass = wazuh: Alert Level: 3; Rule: 502 - Comment; Location: test_location; srcip: 0.0.0.0; user: wazuh;

rule = 502
alert = 3
decoder = wazuh

# Wazuh Agent Buffer

[wazuh: Agent buffer percent]
log 1 pass = wazuh: Agent buffer: '90%'.

rule = 202
alert = 7
decoder = wazuh

[wazuh: Agent buffer full]
log 1 pass = wazuh: Agent buffer: 'full'.

rule = 203
alert = 9
decoder = wazuh

[wazuh: Agent buffer flooded]
log 1 pass = wazuh: Agent buffer: 'flooded'.

rule = 204
alert = 12
decoder = wazuh

[wazuh: Agent buffer normal]
log 1 pass = wazuh: Agent buffer: 'normal'.

rule = 205
alert = 3
decoder = wazuh

# Wazuh Remote Upgrading

[wazuh: Remote upgrading started]
log 1 pass = wazuh: Upgrade procedure on agent 001 (TestAgent): started. Current version: v3.0.0

rule = 212
alert = 3
decoder = wazuh

[wazuh: Remote upgrading aborted]
log 1 pass = wazuh: Upgrade procedure on agent 001 (TestAgent): aborted: Cannot execute installer

rule = 213
alert = 7
decoder = wazuh

[wazuh: Remote upgrading succeeded]
log 1 pass = wazuh: Upgrade procedure on agent 001 (TestAgent): succeeded. New version: v3.1.0

rule = 214
alert = 3
decoder = wazuh

[wazuh: Remote upgrading failed]
log 1 pass = wazuh: Upgrade procedure on agent 001 (TestAgent): failed: Restored to previous version

rule = 215
alert = 6
decoder = wazuh

[wazuh: Remote upgrading disconnected]
log 1 pass = wazuh: Upgrade procedure on agent 001 (TestAgent): lost: Maximum attempts exceeded

rule = 216
alert = 7
decoder = wazuh

# Wazuh Custom Installation

[wazuh: Custom installation started]
log 1 pass = wazuh: Custom installation on agent 001 (TestAgent): started.

rule = 217
alert = 3
decoder = wazuh

[wazuh: Custom installation error]
log 1 pass = wazuh: Custom installation on agent 001 (TestAgent): aborted: Could not verify signature

rule = 218
alert = 7
decoder = wazuh

# Wazuh Invalid Remote Configuration

[wazuh: Invalid remote configuration]
log 1 pass = wazuh: Invalid remote configuration: 'syscheck'

rule = 220
alert = 7
decoder = wazuh

# Wazuh Shared File

[wazuh: Shared file unmerge error]
log 1 pass = wazuh: Could not unmerge shared file.

rule = 222
alert = 7
decoder = wazuh
